<!DOCTYPE html>





<html class="theme-next pisces use-motion" lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="generator" content="Hexo 3.9.0">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.3.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.3.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.3.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.3.0',
    exturl: false,
    sidebar: {"position":"right","display":"post","offset":12,"onmobile":false},
    back2top: {"enable":true,"sidebar":true,"scrollpercent":true},
    save_scroll: false,
    copycode: {"enable":true,"show_result":true,"style":"flat"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    }
  };
</script>

  <meta name="description" content="è¿™ç¯‡æ–‡æ¡£æ˜¯æˆ‘è¿™ä¸€å­¦æœŸå¯¹&apos;åå¾®åˆ†æ–¹ç¨‹æ•°å€¼è§£&apos;ä¸€ä¹¦ä¸­å¤§éƒ¨åˆ†ç®—æ³•çš„æ•´ç†, å­¦ä¹ è¿‡ç¨‹ä¸­æ‰€å†™ä»£ç çš„æ±‡æ€»ä»¥åŠå­¦ä¹ ä½“ä¼š. PS å¯æƒœæˆ‘çš„åŒå­¦çœ‹ä¸åˆ°ğŸ˜†">
<meta name="keywords" content="math">
<meta property="og:type" content="article">
<meta property="og:title" content="å¾®åˆ†æ–¹ç¨‹æ•°å€¼è§£å¤ä¹ æŒ‡åŒ—">
<meta property="og:url" content="https://derivative.ai/2018/06/26/å¾®åˆ†æ–¹ç¨‹æ•°å€¼è§£å¤ä¹ æŒ‡åŒ—/index.html">
<meta property="og:site_name" content="Derivative">
<meta property="og:description" content="è¿™ç¯‡æ–‡æ¡£æ˜¯æˆ‘è¿™ä¸€å­¦æœŸå¯¹&apos;åå¾®åˆ†æ–¹ç¨‹æ•°å€¼è§£&apos;ä¸€ä¹¦ä¸­å¤§éƒ¨åˆ†ç®—æ³•çš„æ•´ç†, å­¦ä¹ è¿‡ç¨‹ä¸­æ‰€å†™ä»£ç çš„æ±‡æ€»ä»¥åŠå­¦ä¹ ä½“ä¼š. PS å¯æƒœæˆ‘çš„åŒå­¦çœ‹ä¸åˆ°ğŸ˜†">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-08-26T11:12:16.117Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="å¾®åˆ†æ–¹ç¨‹æ•°å€¼è§£å¤ä¹ æŒ‡åŒ—">
<meta name="twitter:description" content="è¿™ç¯‡æ–‡æ¡£æ˜¯æˆ‘è¿™ä¸€å­¦æœŸå¯¹&apos;åå¾®åˆ†æ–¹ç¨‹æ•°å€¼è§£&apos;ä¸€ä¹¦ä¸­å¤§éƒ¨åˆ†ç®—æ³•çš„æ•´ç†, å­¦ä¹ è¿‡ç¨‹ä¸­æ‰€å†™ä»£ç çš„æ±‡æ€»ä»¥åŠå­¦ä¹ ä½“ä¼š. PS å¯æƒœæˆ‘çš„åŒå­¦çœ‹ä¸åˆ°ğŸ˜†">
  <link rel="canonical" href="https://derivative.ai/2018/06/26/å¾®åˆ†æ–¹ç¨‹æ•°å€¼è§£å¤ä¹ æŒ‡åŒ—/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>å¾®åˆ†æ–¹ç¨‹æ•°å€¼è§£å¤ä¹ æŒ‡åŒ— | Derivative</title>
  








  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

  <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
  <script type="text/javascript" src="/js/love.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><script src="https://cdn.jsdelivr.net/gh/OpenWaygate/OpenWaygate.github.io@master/CDN/live2d-widget/autoload.js"></script>

  <div class="container sidebar-position-right">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Derivative</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">C'est la vie</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    

  <a href="https://github.com/OpenWaygate" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content page-post-detail">
            

  <div id="posts" class="posts-expand">
    

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://derivative.ai/2018/06/26/å¾®åˆ†æ–¹ç¨‹æ•°å€¼è§£å¤ä¹ æŒ‡åŒ—/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="æ˜¯å›¢å­å•Š">
      <meta itemprop="description" content="æ†‚é¬±æ—¥å’Œ">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Derivative">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">å¾®åˆ†æ–¹ç¨‹æ•°å€¼è§£å¤ä¹ æŒ‡åŒ—

            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2018-06-26 10:19:04" itemprop="dateCreated datePublished" datetime="2018-06-26T10:19:04+08:00">2018-06-26</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-08-26 19:12:16" itemprop="dateModified" datetime="2019-08-26T19:12:16+08:00">2019-08-26</time>
              </span>
            
          

          
            <span class="post-meta-item" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <div id="write" class="is-node show-fences-line-number">
<p>
</p><p>è¿™ç¯‡æ–‡æ¡£æ˜¯æˆ‘è¿™ä¸€å­¦æœŸå¯¹'åå¾®åˆ†æ–¹ç¨‹æ•°å€¼è§£'ä¸€ä¹¦ä¸­å¤§éƒ¨åˆ†ç®—æ³•çš„æ•´ç†, å­¦ä¹ è¿‡ç¨‹ä¸­æ‰€å†™ä»£ç çš„æ±‡æ€»ä»¥åŠå­¦ä¹ ä½“ä¼š. PS å¯æƒœæˆ‘çš„åŒå­¦çœ‹ä¸åˆ°ğŸ˜† <a id="more"></a> ç¬¬äºŒç« è®²çš„æ˜¯åªå«ä¸€ä¸ªæ—¶é—´å˜é‡å’Œä¸€ä¸ªç©ºé—´å˜é‡çš„æŠ›ç‰©å‹æ–¹ç¨‹, åœ¨è¿™ä¸€ç« ä¸­å¼•å…¥äº†æ˜¾å¼/éšå¼çš„æ¦‚å¿µ, æœ€å¤§å€¼åŸç†çš„æˆç«‹æ¡ä»¶, é€šè¿‡æˆªæ–­è¯¯å·®å’Œé€¼è¿‘è¯¯å·®åˆ†æç®—æ³•æ”¶æ•›æ€§å’Œåˆ©ç”¨å‚…é‡Œå¶åˆ†æå¯¹ç®—æ³•ç¨³å®šæ€§çš„æ¢è®¨. å…¶ä¸­, Crankâ€“Nicolson æ–¹æ³•å› ä¸ºåˆç†åˆ©ç”¨äº†æ˜¾éšæ ¼å¼çš„ä¼˜ç‚¹, åœ¨ç²¾åº¦å’Œç®—æ³•å¤æ‚åº¦ä¸Šå…·æœ‰ä¼˜åŠ¿.</p>
<p>ç¬¬ä¸‰ç« æ˜¯ç¬¬ä¸€ç« åœ¨äºŒä¸‰ç»´æƒ…å†µä¸‹çš„æ¨å¹¿, ä¸»è¦ä»‹ç»äº† ADI æ–¹æ³•å’Œ LOD æ–¹æ³•, ADI æ–¹æ³•å¯ä»¥çœ‹ä½œ Crankâ€“Nicolson æ–¹æ³•åœ¨äºŒç»´çš„æ¨å¹¿, LOD æ–¹æ³•åœ¨ b(<span class="math inline">\(\nabla^2 u\)</span>çš„ç³»æ•°) ä¸ºå¸¸æ•°æ—¶ä¸ ADI æ–¹æ³•ç­‰ä»·.</p>
<p>ç¬¬å››ç« è®²äº†ä¸€ç»´åŒæ›²å‹æ–¹ç¨‹, ç‰¹å¾çº¿æ–¹æ³•ç»™å‡ºäº†åˆå§‹æ¡ä»¶éšæ—¶é—´çš„æ›²çº¿, CFL æ¡ä»¶ç»™å‡ºäº†å·®åˆ†æ ¼å¼ç¨³å®šæ€§çš„ä¸€ä¸ªå¿…è¦æ¡ä»¶, è¿™å¯ä»¥ç»“åˆç‰¹å¾çº¿å’Œç½‘æ ¼å›¾ å¾ˆç›´è§‚åœ°çœ‹å‡º. æœ€ç®€å•ç´§å‡‘çš„æ ¼å¼æ˜¯è¿é£æ ¼å¼, ç»“åˆè¯¾åä¹ é¢˜ä¸­æ¨å¹¿çš„è¿é£æ ¼å¼å’Œ'è¿é£'çš„å½¢è±¡ç¿»è¯‘, å¯ä»¥ç†è§£æˆé£è¶Šå¤§(ç‰¹å¾çº¿è¶Šæ–œ), ä¾èµ–åŒºåŸŸå°±è¢«å¹å¾—è¶Šè¿œ(ä¸ºäº†æ»¡è¶³ CFL æ¡ä»¶). ç”±äºè¿é£æ ¼å¼æ˜¯çº¿æ€§æ’å€¼, ç²¾åº¦åªæœ‰ä¸€é˜¶, æ•…å¯ç”¨ä¸Šä¸€æ—¶é—´å±‚çš„ä¸‰ç‚¹åšäºŒé˜¶é€¼è¿‘, æ­¤å³ä¸º Laxâ€“Wendroff æ ¼å¼, ä¸ºæ»¡è¶³ CFL æ¡ä»¶, éœ€è¦<span class="math inline">\(\vert\nu\vert &lt; 1\)</span>, æ ¹æ®æ¨å¹¿çš„è¿é£æ ¼å¼æ¨æµ‹, å¯èƒ½ä¹Ÿæœ‰æ¨å¹¿çš„ è¿é£Laxâ€“Wendroff æ ¼å¼. æœ‰é™ä½“ç§¯æ ¼å¼ä»ç§¯åˆ†çš„è§’åº¦ç»™å‡ºäº†æ–°çš„æ•°å€¼é€¼è¿‘æ–¹æ³•, å¹¶å¼•å‡ºäº† TVD çš„æ¦‚å¿µ. åœ¨ç›’å¼æ ¼å¼ä¸­, ç”±äºå…¶æ— è€—æ•£çš„ç‰¹æ€§, å¼•å…¥äº†ä¸€ä¸ªå¯å‘æ€§çš„æ¦‚å¿µ--ç¾¤é€Ÿåº¦, ç”¨äºè¡¨ç¤ºè‰²æ•£ PDE ä¸­èƒ½é‡çš„ä¼ æ’­é€Ÿåº¦. è›™è·³æ ¼å¼å¯åˆ†ä¸ºéäº¤é”™å‹å’Œäº¤é”™å‹, åœ¨äº¤é”™å‹ä¸­ä¼šäº§ç”Ÿä¼ªè§£æ³¢å‹, éœ€è¦å°†å…¶æ»¤æ‰.</p>
<p>ä¸‹ä¸€å­¦æœŸå¯ä»¥æ ¹æ®æ–°çš„ç« èŠ‚å®Œå–„å¯¹æœ¬ä¹¦ç®—æ³•çš„æ•´ç†.</p>
<p>é™¤äº†ç®—æ³•çš„å­¦ä¹ , å¦ä¸€ä¸ªé‡è¦çš„è¿›æ­¥æ˜¯å¯¹Pythonå’ŒMarkdownçš„æŒæ¡, ä¸Šå­¦æœŸä¸»è¦å¯¹åº”ç”¨çš„æ˜¯Matlabå’ŒLatex. æ¢åˆ°æ–°çš„ä»£ç ç¯å¢ƒç»å†äº†ä¸€æ®µé€‚åº”æœŸ, ä½†Pythonä»¥å…¶å¼€æºã€æ´»è·ƒçš„ç¤¾åŒºã€é«˜æ•ˆç‡çš„ç¼–è¾‘å™¨è®©æˆ‘è¿…é€ŸæŠ›å¼ƒäº†Matlab.</p>
<h2 id="u_t-u_xx"><span class="math inline">\(u_t = u_{xx}\)</span></h2>
<table>
<colgroup>
<col style="width: 16%">
<col style="width: 24%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th style="text-align: center;">Scheme</th>
<th style="text-align: center;">T</th>
<th style="text-align: center;"><span class="math inline">\(E^n\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\lambda\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Explicit scheme</td>
<td style="text-align: center;"><span class="math inline">\(U_j^{n + 1} = \mu\delta_x^2U_j^n\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{\Delta t}{2}u_{}tt - \frac{(\Delta x)^2}{12}u_{xxxx}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{\Delta t}{2}(M_{tt} + \frac{1}{6\mu}M_{xxxx})\)</span></td>
<td style="text-align: center;"><span class="math inline">\(1 - 4\mu \sin^2\frac{k\Delta x}{2}\)</span></td>
</tr>
<tr class="even">
<td>Implicit method</td>
<td style="text-align: center;"><span class="math inline">\(\Delta_{-t}U_j^{n + 1} = \mu\delta_x^2U_j^{n + 1}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\frac{1}{1 + 4\mu \sin^2\frac{k\Delta x}{2}}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\theta\)</span>-method</td>
<td style="text-align: center;"><span class="math inline">\(\Delta_{+t}U_j^{n} = \mu(\theta\delta_x^2U_j^{n + 1} + (1 - \theta)\delta_x^2U_j^{n})\)</span></td>
<td style="text-align: center;"><span class="math inline">\((\frac{1}{2} - \theta)\Delta tu_{xxt} - \frac{u_{xxxx}}{12}(\Delta x)^2 + \frac{u_{ttt} - 3u_{xxtt}}{24}(\Delta t)^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n\Delta t\max\limits_m T^{m + \frac{1}{2}}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{1 - 4(1 - \theta)\mu \sin^2(\frac{k\Delta x}{2})}{1 + 4\theta\mu \sin^2\frac{k\Delta x}{2}}\)</span></td>
</tr>
<tr class="even">
<td>Crankâ€“Nicolson scheme</td>
<td style="text-align: center;"><span class="math inline">\(\Delta_{+t}U_j^{n} = \frac{\mu}{2}(\delta_x^2U_j^{n + 1} + \delta_x^2U_j^{n})\)</span></td>
<td style="text-align: center;"><span class="math inline">\(-\frac{1}{12}[(\Delta x)^2u_{xxxx} + (\Delta t)^2u_{ttt}]_j^{n + \frac{1}{2}}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n\Delta t\max\limits_m T^{m + \frac{1}{2}}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{1 - 2\mu \sin^2(\frac{k\Delta x}{2})}{1 + 2\mu \sin^2\frac{k\Delta x}{2}}\)</span></td>
</tr>
</tbody>
</table>
<details>
<p><summary>Python code for explicit method, figure 2.2</summary></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">delta_t1 = <span class="number">0.0012</span></span><br><span class="line">delta_t2 = <span class="number">0.0013</span></span><br><span class="line">delta_x = <span class="number">0.05</span></span><br><span class="line">x = np.arange(<span class="number">0</span>, <span class="number">1.01</span>, delta_x)</span><br><span class="line">U_1 = np.hstack((<span class="number">2</span> * x[:<span class="number">10</span>], <span class="number">2</span> - <span class="number">2</span> * x[<span class="number">10</span>:]))</span><br><span class="line">U_2 = U_1.copy()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">50</span>):</span><br><span class="line">    U_1[<span class="number">1</span>:<span class="number">20</span>] = U_1[<span class="number">1</span>:<span class="number">20</span>] + (delta_t1 / delta_x ** <span class="number">2</span>) * (U_1[<span class="number">2</span>:<span class="number">21</span>] - <span class="number">2</span> * U_1[<span class="number">1</span>:<span class="number">20</span>] + U_1[<span class="number">0</span>:<span class="number">19</span>])</span><br><span class="line">    U_2[<span class="number">1</span>:<span class="number">20</span>] = U_2[<span class="number">1</span>:<span class="number">20</span>] + (delta_t2 / delta_x ** <span class="number">2</span>) * (U_2[<span class="number">2</span>:<span class="number">21</span>] - <span class="number">2</span> * U_2[<span class="number">1</span>:<span class="number">20</span>] + U_2[<span class="number">0</span>:<span class="number">19</span>])</span><br><span class="line"></span><br><span class="line">plt.figure()</span><br><span class="line">fig_1, = plt.plot(x, U_1)</span><br><span class="line">fig_2, = plt.plot(x, U_2)</span><br><span class="line">plt.xlabel(<span class="string">'x'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'U'</span>)</span><br><span class="line">plt.legend(handles=[fig_1, fig_2], labels=[<span class="string">'Î”t = 0.0012'</span>, <span class="string">'Î”t = 0.0013'</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
</details>
<details>
<p><summary>Python code for Crankâ€“Nicolson method, figure 2.9</summary></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize</span></span><br><span class="line">mu1 = <span class="number">1</span></span><br><span class="line">mu2 = <span class="number">2</span></span><br><span class="line">x = np.arange(<span class="number">21</span>) * <span class="number">0.05</span></span><br><span class="line">U1 = np.zeros((<span class="number">21</span>, <span class="number">1</span>))</span><br><span class="line">U1[<span class="number">10</span>] = <span class="number">1.</span></span><br><span class="line">U2 = U1.copy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># A * U^&#123;n + 1&#125; = B * U^&#123;n&#125;, need not iterate U[0]&amp;U[20]</span></span><br><span class="line">A1 = np.eye(<span class="number">19</span>, k=<span class="number">-1</span>) * (-mu1/<span class="number">2</span>) + np.eye(<span class="number">19</span>) * (<span class="number">1</span> + mu1) \</span><br><span class="line">    + np.eye(<span class="number">19</span>, k=<span class="number">1</span>) * (-mu1/<span class="number">2</span>)</span><br><span class="line">A2 = np.eye(<span class="number">19</span>, k=<span class="number">-1</span>) * (-mu2/<span class="number">2</span>) + np.eye(<span class="number">19</span>) * (<span class="number">1</span> + mu2) \</span><br><span class="line">    + np.eye(<span class="number">19</span>, k=<span class="number">1</span>) * (-mu2/<span class="number">2</span>)</span><br><span class="line">B1 = np.eye(<span class="number">19</span>, k=<span class="number">-1</span>) * (mu1/<span class="number">2</span>) + np.eye(<span class="number">19</span>) * (<span class="number">1</span> - mu1) \</span><br><span class="line">    + np.eye(<span class="number">19</span>, k=<span class="number">1</span>) * (mu1/<span class="number">2</span>)</span><br><span class="line">B2 = np.eye(<span class="number">19</span>, k=<span class="number">-1</span>) * (mu2/<span class="number">2</span>) + np.eye(<span class="number">19</span>) * (<span class="number">1</span> - mu2) \</span><br><span class="line">    + np.eye(<span class="number">19</span>, k=<span class="number">1</span>) * (mu2/<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_it</span><span class="params">(U1, U2, x, i, ax)</span>:</span></span><br><span class="line">    ax.plot(x, U1)</span><br><span class="line">    ax.plot(x, U2)</span><br><span class="line">    i = str(i + <span class="number">1</span>) <span class="keyword">if</span> i != <span class="number">0</span> <span class="keyword">else</span> <span class="string">''</span></span><br><span class="line">    ax.set_xlabel(<span class="string">'x, t = '</span> + i + <span class="string">'Î”t'</span>)</span><br><span class="line">    ax.set_ylabel(<span class="string">'U'</span>)</span><br><span class="line">    ax.legend(labels=[<span class="string">'Î¼ = 1'</span>, <span class="string">'Î¼ = 2'</span>])</span><br><span class="line"></span><br><span class="line">plt.figure()</span><br><span class="line">fig, axes = plt.subplots(<span class="number">2</span>, <span class="number">3</span>, figsize=(<span class="number">18</span>, <span class="number">8</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">11</span>):</span><br><span class="line">    U1[<span class="number">1</span>:<span class="number">20</span>] = np.linalg.solve(A1, B1.dot(U1[<span class="number">1</span>:<span class="number">20</span>]))</span><br><span class="line">    U2[<span class="number">1</span>:<span class="number">20</span>] = np.linalg.solve(A2, B2.dot(U2[<span class="number">1</span>:<span class="number">20</span>]))</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        plot_it(U1, U2, x, i, axes[i//<span class="number">6</span>, (<span class="number">2</span> * i) % <span class="number">3</span>])</span><br></pre></td></tr></table></figure>
</details>
<h2 id="u_t-nabla2u"><span class="math inline">\(u_t = \nabla^2u\)</span></h2>
<table>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th style="text-align: center;">Scheme</th>
<th style="text-align: center;">T</th>
<th style="text-align: center;"><span class="math inline">\(\lambda\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ADI method in two dimensions</td>
<td style="text-align: center;"><span class="math inline">\((1 - \frac{\mu_x}{2}\delta_x^2)U^{n + \frac{1}{2}} = (1 + \frac{\mu_y}{2}\delta_y^2)U^{n}\)</span> <br> <span class="math inline">\((1 - \frac{\mu_y}{2}\delta_y^2)U^{n + 1} = (1 + \frac{\mu_x}{2}\delta_x^2)U^{n + \frac{1}{2}}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(O((\Delta t)^2 + (\Delta x)^2 + (\Delta y)^2)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\dfrac{(1 - 2\mu_x \sin^2(\frac{k_x\Delta x}{2}))(1 - 2\mu_y \sin^2(\frac{k_y\Delta y}{2}))}{(1 + 2\mu_x \sin^2\frac{k_x\Delta x}{2})(1 + 2\mu_y \sin^2\frac{k_y\Delta y}{2})}\)</span></td>
</tr>
<tr class="even">
<td>LOD methods</td>
<td style="text-align: center;"><span class="math inline">\((1 - \frac{\mu_x}{2}\delta_x^2)U^{n + *} = (1 + \frac{\mu_x}{2}\delta_x^2)U^{n}\)</span> <br> <span class="math inline">\((1 - \frac{\mu_y}{2}\delta_y^2)U^{n + **} = (1 + \frac{\mu_y}{2}\delta_y^2)U^{n + *}\)</span> <br> <span class="math inline">\((1 - \frac{\mu_z}{2}\delta_z^2)U^{n + 1} = (1 + \frac{\mu_z}{2}\delta_z^2)U^{n + **}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<details>
<p><summary>Python code for ADI method in two dimensions</summary></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># function to plot the figure in time t</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_it</span><span class="params">(U, X, Y, t, ax)</span>:</span></span><br><span class="line">    ax.plot_surface(X, Y, U)</span><br><span class="line">    t = str(t + <span class="number">1</span>) <span class="keyword">if</span> t != <span class="number">0</span> <span class="keyword">else</span> <span class="string">''</span></span><br><span class="line">    ax.set_xlabel(<span class="string">'x, t = '</span> + t + <span class="string">'Î”t'</span>)</span><br><span class="line">    ax.set_ylabel(<span class="string">'y'</span>)</span><br><span class="line">    ax.set_zlabel(<span class="string">'U'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ADI</span><span class="params">(J, K, mu_x, mu_y)</span>:</span></span><br><span class="line">    <span class="comment"># x.shape = y.shape = (J + 1,)</span></span><br><span class="line">    x = np.linspace(<span class="number">0</span>, <span class="number">2</span>, J + <span class="number">1</span>)  <span class="comment"># x = [0, 2/J, 4/J, ... 2]</span></span><br><span class="line">    y = np.linspace(<span class="number">0</span>, <span class="number">2</span>, K + <span class="number">1</span>)  <span class="comment"># y = [0, 2/K, 4/K, ... 2]</span></span><br><span class="line">    U = np.zeros((J + <span class="number">1</span>, K + <span class="number">1</span>))    </span><br><span class="line">    X, Y = np.meshgrid(x, y)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> range(J + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> s <span class="keyword">in</span> range(K + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> (x[r] - <span class="number">1</span>)**<span class="number">2</span> + (y[s] - <span class="number">1</span>)**<span class="number">2</span> &lt;= <span class="number">0.25</span>:</span><br><span class="line">                U[r, s] = <span class="number">1</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">##    plot the initial state</span></span><br><span class="line"><span class="comment">#     fig = plt.figure(figsize=(18, 18))</span></span><br><span class="line"><span class="comment">#     ax = fig.add_subplot(1, 1, 1, projection='3d')</span></span><br><span class="line"><span class="comment">#     plot_it(U, X, Y, 0, ax)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># A1 * U[1:J, s] = U[1:J, s - 1:s + 2] * B1</span></span><br><span class="line">    <span class="comment"># A2 * U[r, 1:K]' = U[r - 1:r + 2, 1:K]' * B2'</span></span><br><span class="line">    A1 = np.eye(J - <span class="number">1</span>, k=<span class="number">-1</span>) * (-mu_x/<span class="number">2</span>) + np.eye(J - <span class="number">1</span>) * (<span class="number">1</span> + mu_x) \</span><br><span class="line">        + np.eye(J - <span class="number">1</span>, k=<span class="number">1</span>) * (-mu_x/<span class="number">2</span>)</span><br><span class="line">    A2 = np.eye(K - <span class="number">1</span>, k=<span class="number">-1</span>) * (-mu_y/<span class="number">2</span>) + np.eye(K - <span class="number">1</span>) * (<span class="number">1</span> + mu_y) \</span><br><span class="line">        + np.eye(K - <span class="number">1</span>, k=<span class="number">1</span>) * (-mu_y/<span class="number">2</span>)</span><br><span class="line">    B1 = np.array([[mu_y/<span class="number">2</span>], [<span class="number">1</span> - mu_y], [mu_y/<span class="number">2</span>]])</span><br><span class="line">    B2 = np.array([[mu_x/<span class="number">2</span>, <span class="number">1</span> - mu_x, mu_x/<span class="number">2</span>]]) </span><br><span class="line">        </span><br><span class="line">    fig = plt.figure(figsize=(<span class="number">18</span>, <span class="number">80</span>))  </span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">        <span class="comment"># A1 * U[1:J, s] = U[1:J, s - 1:s + 2] * B1</span></span><br><span class="line">        <span class="keyword">for</span> s <span class="keyword">in</span> range(<span class="number">1</span>, K):</span><br><span class="line">            U[<span class="number">1</span>:J, s:s + <span class="number">1</span>] = np.linalg.solve(A1, U[<span class="number">1</span>:J, s - <span class="number">1</span>:s + <span class="number">2</span>].dot(B1))</span><br><span class="line">        <span class="comment"># A2 * U[r, 1:K]' = U[r - 1:r + 2, 1:K]' * B2'</span></span><br><span class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> range(<span class="number">1</span>, J):</span><br><span class="line">            U[r:r + <span class="number">1</span>, <span class="number">1</span>:K] = np.linalg.solve(A2, U[r - <span class="number">1</span>:r + <span class="number">2</span>, <span class="number">1</span>:K].T.dot(B2.T)).T</span><br><span class="line"></span><br><span class="line">        <span class="comment"># plot figure for each 5 time-steps</span></span><br><span class="line">        <span class="keyword">if</span> t%<span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">            ax = fig.add_subplot(<span class="number">10</span>, <span class="number">2</span>, t / <span class="number">5</span> + <span class="number">1</span>, projection=<span class="string">'3d'</span>)</span><br><span class="line">            plot_it(U, X, Y, t, ax)</span><br></pre></td></tr></table></figure>
</details>
<details>
<p><summary>Python code for LOD method in two dimensions</summary></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># function to plot the figure in time t</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_it</span><span class="params">(U, X, Y, t, ax)</span>:</span></span><br><span class="line">    ax.plot_surface(X, Y, U)</span><br><span class="line">    t = str(t + <span class="number">1</span>) <span class="keyword">if</span> t != <span class="number">0</span> <span class="keyword">else</span> <span class="string">''</span></span><br><span class="line">    ax.set_xlabel(<span class="string">'x, t = '</span> + t + <span class="string">'Î”t'</span>)</span><br><span class="line">    ax.set_ylabel(<span class="string">'y'</span>)</span><br><span class="line">    ax.set_zlabel(<span class="string">'U'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">LOD</span><span class="params">(J, K, mu_x, mu_y)</span>:</span></span><br><span class="line">    x = np.linspace(<span class="number">0</span>, <span class="number">2</span>, J + <span class="number">1</span>)  <span class="comment"># x = [0, 1/J, 2/J, ... 2]</span></span><br><span class="line">    y = np.linspace(<span class="number">0</span>, <span class="number">2</span>, K + <span class="number">1</span>)  <span class="comment"># y = [0, 1/K, 2/K, ... 2]</span></span><br><span class="line">    U = np.zeros((J + <span class="number">1</span>, K + <span class="number">1</span>))    </span><br><span class="line">    X, Y = np.meshgrid(x, y)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> range(J + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> s <span class="keyword">in</span> range(K + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> (x[r] - <span class="number">1</span>)**<span class="number">2</span> + (y[s] - <span class="number">1</span>)**<span class="number">2</span> &lt;= <span class="number">0.25</span>:</span><br><span class="line">                U[r, s] = <span class="number">1</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">##    plot the initial state</span></span><br><span class="line"><span class="comment">#     fig = plt.figure(figsize=(18, 18))</span></span><br><span class="line"><span class="comment">#     ax = fig.add_subplot(1, 1, 1, projection='3d')</span></span><br><span class="line"><span class="comment">#     plot_it(U, X, Y, 0, ax)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># A1 * U[1:J, s] = B1 * U[1:J, s]</span></span><br><span class="line">    <span class="comment"># A2 * U[r, 1:K] = B2 * U[r, 1:K]</span></span><br><span class="line">    A1 = np.eye(J - <span class="number">1</span>, k=<span class="number">-1</span>) * (-mu_x/<span class="number">2</span>) + np.eye(J - <span class="number">1</span>) * (<span class="number">1</span> + mu_x) \</span><br><span class="line">        + np.eye(J - <span class="number">1</span>, k=<span class="number">1</span>) * (-mu_x/<span class="number">2</span>)</span><br><span class="line">    A2 = np.eye(K - <span class="number">1</span>, k=<span class="number">-1</span>) * (-mu_y/<span class="number">2</span>) + np.eye(K - <span class="number">1</span>) * (<span class="number">1</span> + mu_y) \</span><br><span class="line">        + np.eye(K - <span class="number">1</span>, k=<span class="number">1</span>) * (-mu_y/<span class="number">2</span>)</span><br><span class="line">    B1 = np.eye(J - <span class="number">1</span>, k=<span class="number">-1</span>) * (mu_x/<span class="number">2</span>) + np.eye(J - <span class="number">1</span>) * (<span class="number">1</span> - mu_x) \</span><br><span class="line">        + np.eye(J - <span class="number">1</span>, k=<span class="number">1</span>) * (mu_x/<span class="number">2</span>)</span><br><span class="line">    B2 =  np.eye(K - <span class="number">1</span>, k=<span class="number">-1</span>) * (mu_y/<span class="number">2</span>) + np.eye(K - <span class="number">1</span>) * (<span class="number">1</span> - mu_y) \</span><br><span class="line">        + np.eye(K - <span class="number">1</span>, k=<span class="number">1</span>) * (mu_y/<span class="number">2</span>)</span><br><span class="line">        </span><br><span class="line">    fig = plt.figure(figsize=(<span class="number">18</span>, <span class="number">80</span>))  </span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">        <span class="comment"># A1 * U[1:J, s] = B1 * U[1:J, s]</span></span><br><span class="line">        <span class="keyword">for</span> s <span class="keyword">in</span> range(<span class="number">1</span>, K):</span><br><span class="line">            U[<span class="number">1</span>:J, s] = np.linalg.solve(A1, B1.dot(U[<span class="number">1</span>:J, s]))</span><br><span class="line">        <span class="comment"># A2 * U[r, 1:K] = B2 * U[r, 1:K]</span></span><br><span class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> range(<span class="number">1</span>, J):</span><br><span class="line">            U[r, <span class="number">1</span>:K] = np.linalg.solve(A2, B2.dot(U[r, <span class="number">1</span>:K]))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># plot figure for each 5 time-steps</span></span><br><span class="line">        <span class="keyword">if</span> t%<span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">            ax = fig.add_subplot(<span class="number">10</span>, <span class="number">2</span>, t / <span class="number">5</span> + <span class="number">1</span>, projection=<span class="string">'3d'</span>)</span><br><span class="line">            plot_it(U, X, Y, t, ax)</span><br></pre></td></tr></table></figure>
</details>
<h2 id="u_t-au_x-0"><span class="math inline">\(u_t + au_x = 0\)</span></h2>
<table>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th style="text-align: center;">Scheme</th>
<th style="text-align: center;">T</th>
<th style="text-align: center;">E</th>
<th style="text-align: center;"><span class="math inline">\(\lambda, \arg\lambda\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Upwind scheme</td>
<td style="text-align: center;"><span class="math inline">\(U_j^{n + 1} = \begin{cases} (1 + \nu)U_j^n - \nu U_{j + 1}^m &amp; \text{$\alpha &lt; 0$} \\(1 - \nu)U_j^n + \nu U_{j - 1}^m &amp; \text{$\alpha &gt; 0$}\end{cases}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{1}{2}(\Delta tu_{tt} - a\Delta xu_{xx})\)</span></td>
<td style="text-align: center;"><span class="math inline">\(t_FT\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\lambda(k) = 1 - \nu(1 - e^{-ik\Delta x})\)</span> <br> <span class="math inline">\(\vert\lambda\vert^2 = 1 - 4\nu(1 - \nu)\sin^2\frac{k\Delta x}{2}\)</span> <br> <span class="math inline">\(\begin{align*} \arg\lambda &amp;= -\tan^{-1}[\frac{\nu\sin k\Delta x}{1 - \nu + \nu\cos k\Delta x}] \\ &amp;\approx -\nu\xi[1 - \frac{1}{6}(1 - \nu)(1 - 2\nu)\xi^2 + \cdots]\end{align*}\)</span></td>
</tr>
<tr class="even">
<td>Laxâ€“Wendroff scheme</td>
<td style="text-align: center;"><span class="math inline">\(U_j^{n + 1} = U_j^n - \nu\Delta_{0x}U_j^n + \frac{1}{2}\nu^2\delta_x^2U_j^n\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\lambda(k) = 1 - i\nu\sin k\Delta x - 2\nu^2\sin^2\frac{k\Delta x}{2}\)</span> <br> <span class="math inline">\(\vert\lambda\vert^2 = 1 - 4\nu^2(1 - \nu^2)\sin^4\frac{k\Delta x}{2}\)</span> <br> <span class="math inline">\(\arg\lambda\approx -\nu\xi[1 - \frac{1}{6}(1 - \nu^2)\xi^2]\)</span></td>
</tr>
<tr class="odd">
<td>Finite volume schemes</td>
<td style="text-align: center;"><span class="math inline">\(U_j^{n + 1} = U_j^{n} - \frac{\Delta t}{\Delta x}\delta_xF_j^{n + \frac{1}{2}}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>Box scheme</td>
<td style="text-align: center;"><span class="math inline">\((\mu_x\delta_t + \nu\mu_t\delta_x)U_{j + \frac{1}{2}}^{n + \frac{1}{2}} = 0\)</span> <br> <span class="math inline">\(U_{j + 1}^{n + 1} = U_j^n + (1 + \nu_{j + \frac{1}{2}}^{n + \frac{1}{2}})^{-1}(1 - \nu_{j + \frac{1}{2}}^{n + \frac{1}{2}})(U_{j + 1}^n - U_j^{n + 1})\)</span> <br> <span class="math inline">\(\nu_{j + \frac{1}{2}}^{n + \frac{1}{2}} = a_{j + \frac{1}{2}}^{n + \frac{1}{2}}\frac{\Delta t}{\Delta x}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\lambda(k) = \dfrac{\cos\frac{k\Delta x}{2} - i\nu\sin\frac{k\Delta x}{2}}{\cos\frac{k\Delta x}{2} + i\nu\sin\frac{k\Delta x}{2}}\)</span> <br> <span class="math inline">\(\begin{align*} \arg\lambda &amp;= -2\tan^{-1}(\nu\tan\frac{k\Delta x}{2}) \\ &amp;\approx -\nu\xi[1 + \frac{1}{12}(1 - \nu^2)\xi^2 + \cdots]\end{align*}\)</span></td>
</tr>
<tr class="odd">
<td>Leap-frog scheme(unstaggered)</td>
<td style="text-align: center;"><span class="math inline">\(U_j^{n + 1} = U_j^{n - 1} - a\frac{\Delta t}{\Delta x}(U_{j + 1}^n - U_{j - 1}^n)\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\lambda(k) = -i\nu\sin k\Delta x \pm(1 - \nu^2\sin^2k\Delta x)^{\frac{1}{2}}\)</span> <br> <span class="math inline">\(\begin{align*} \arg\lambda_T &amp;= -\sin^{-1}(\nu\sin k\Delta x) \\ &amp;\approx -\nu\xi[1 - \frac{1}{6}(1 - \nu^2)\xi^2 + \cdots]\end{align*}\)</span></td>
</tr>
<tr class="even">
<td>Leap-frog scheme(staggered)</td>
<td style="text-align: center;"><span class="math inline">\(\delta_tV + \nu\delta_xW = 0, \delta_tW + \nu\delta_xV = 0\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\lambda_{\pm}(k) = 1 - 2\nu^2s^2\pm 2i\nu s(1 - \nu^2 s^2)^{\frac{1}{2}}, s = \sin\frac{k\Delta x}{2}\)</span> <br> <span class="math inline">\(\begin{align*} \arg\lambda_{\pm} &amp;= \pm\sin^{-1}[2\nu s(1 - \nu^2 s^2)^{\frac{1}{2}}] \\ &amp;\approx \pm\nu\xi[1 - \frac{1}{24}(1 - \nu^2)\xi^2 + \cdots]\end{align*}\)</span></td>
</tr>
</tbody>
</table>
<details>
<p><summary>Python code for upwind scheme, figure 4.6</summary></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># function to plot the figure in time t</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_it</span><span class="params">(x, U, t, ax)</span>:</span></span><br><span class="line">    ax.plot(x, U)</span><br><span class="line">    t = str(t + <span class="number">1</span>) <span class="keyword">if</span> t != <span class="number">0</span> <span class="keyword">else</span> <span class="string">''</span></span><br><span class="line">    ax.set_xlabel(<span class="string">'x, t = '</span> + t + <span class="string">'Î”t'</span>)</span><br><span class="line">    ax.set_ylabel(<span class="string">'U'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a_xt</span><span class="params">(n, j, Delta_x = <span class="number">0.02</span>)</span>:</span></span><br><span class="line">    Delta_t = Delta_x</span><br><span class="line">    x = j * Delta_x</span><br><span class="line">    t = n * Delta_t</span><br><span class="line">    a = (<span class="number">1</span> + x**<span class="number">2</span>) / (<span class="number">1</span> + <span class="number">2</span> * x * t + <span class="number">2</span> * x**<span class="number">2</span> + x**<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Upwind</span><span class="params">(Delta_x = <span class="number">0.02</span>)</span>:</span></span><br><span class="line">    J = int(<span class="number">2</span> / Delta_x)</span><br><span class="line">    x = np.linspace(<span class="number">0</span>, <span class="number">2</span>, J + <span class="number">1</span>)</span><br><span class="line">    U = np.zeros(J + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(J + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">0.2</span> &lt;= x[j] &lt;= <span class="number">0.4</span>:</span><br><span class="line">            U[j] = <span class="number">1</span></span><br><span class="line">    U1 = U.copy()</span><br><span class="line"><span class="comment"># #    plot the initial state</span></span><br><span class="line"><span class="comment">#     fig1 = plt.figure(figsize=(9, 6))</span></span><br><span class="line"><span class="comment">#     ax = fig1.add_subplot(1, 1, 1)</span></span><br><span class="line"><span class="comment">#     plot_it(x, U, 0, ax)</span></span><br><span class="line">    </span><br><span class="line">    fig = plt.figure(figsize=(<span class="number">18</span>, <span class="number">120</span>))</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, J):</span><br><span class="line">            U1[j] = (<span class="number">1</span> - a_xt(n + <span class="number">1</span>, j, Delta_x)) * U[j] + a_xt(n + <span class="number">1</span>, j, Delta_x) * U[j - <span class="number">1</span>]</span><br><span class="line">        U = U1.copy()</span><br><span class="line">        ax = fig.add_subplot(<span class="number">15</span>, <span class="number">2</span>, n + <span class="number">1</span>)</span><br><span class="line">        plot_it(x, U, n, ax)</span><br></pre></td></tr></table></figure>
</details>
<details>
<p><summary>Python code for Laxâ€“Wendroff scheme, figure 4.7 4.8</summary></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># function to plot the figure in time t</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_it</span><span class="params">(x, U, t, ax, U_true = <span class="number">0</span>)</span>:</span></span><br><span class="line">    ax.plot(x, U, label = <span class="string">'Numerical Solution'</span>)</span><br><span class="line">    ax.plot(x, U_true, <span class="string">'--'</span>, label = <span class="string">'Exact Solution'</span>)</span><br><span class="line">    t = str(t + <span class="number">1</span>) <span class="keyword">if</span> t != <span class="number">0</span> <span class="keyword">else</span> <span class="string">''</span></span><br><span class="line">    ax.set_xlabel(<span class="string">'x, t = '</span> + t + <span class="string">'Î”t'</span>)</span><br><span class="line">    ax.set_ylabel(<span class="string">'U'</span>)</span><br><span class="line">    ax.legend()</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a_</span><span class="params">(n, j, Delta_x = <span class="number">0.02</span>)</span>:</span></span><br><span class="line">    Delta_t = Delta_x</span><br><span class="line">    x = j * Delta_x</span><br><span class="line">    t = n * Delta_t</span><br><span class="line">    a = (<span class="number">1</span> + x**<span class="number">2</span>) / (<span class="number">1</span> + <span class="number">2</span> * x * t + <span class="number">2</span> * x**<span class="number">2</span> + x**<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">U_</span><span class="params">(J, x, issmooth)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> issmooth:</span><br><span class="line">        U = np.exp(<span class="number">-10</span> * (<span class="number">4</span> * x - <span class="number">1</span>)**<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        U = np.zeros(J + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(J + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="number">0.2</span> &lt;= x[j] &lt;= <span class="number">0.4</span>:</span><br><span class="line">                U[j] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> U</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lax_wendroff</span><span class="params">(Delta_x = <span class="number">0.02</span>, issmooth = False)</span>:</span></span><br><span class="line">    Delta_t = Delta_x</span><br><span class="line">    J = int(<span class="number">2</span> / Delta_x)</span><br><span class="line">    x = np.linspace(<span class="number">0</span>, <span class="number">2</span>, J + <span class="number">1</span>)</span><br><span class="line">    U = U_(J, x, issmooth)</span><br><span class="line">    U0 = U.copy() <span class="comment"># cache for initial state</span></span><br><span class="line">    U1 = U.copy() <span class="comment"># cache for U</span></span><br><span class="line">    U_true = np.zeros(J + <span class="number">1</span>) <span class="comment"># The exact solution</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># #    plot the initial state</span></span><br><span class="line"><span class="comment">#     initial = plt.figure(figsize=(9, 6))</span></span><br><span class="line"><span class="comment">#     ax = initial.add_subplot(1, 1, 1)</span></span><br><span class="line"><span class="comment">#     plot_it(x, U, -1, ax)</span></span><br><span class="line">    </span><br><span class="line">    fig = plt.figure(figsize=(<span class="number">18</span>, <span class="number">50</span>))</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, J):</span><br><span class="line">            U1[j] = U[j] - <span class="number">0.5</span> * a_(n + <span class="number">0.5</span>, j, Delta_x) * (U[j + <span class="number">1</span>] - U[j - <span class="number">1</span>]) + \</span><br><span class="line">                    <span class="number">0.5</span> * a_(n, j, Delta_x) * (a_(n, j + <span class="number">0.5</span>, Delta_x) * (U[j + <span class="number">1</span>] - U[j]) - \</span><br><span class="line">                                               a_(n, j - <span class="number">0.5</span>, Delta_x) * (U[j] - U[j - <span class="number">1</span>]))</span><br><span class="line">            j_star = (j * Delta_x - ((n + <span class="number">1</span>) * Delta_t) / (<span class="number">1</span> + (j * Delta_x)**<span class="number">2</span>)) / Delta_x</span><br><span class="line">            U_true[j] = U0[int(j_star)]</span><br><span class="line">        U = U1.copy()</span><br><span class="line">        <span class="keyword">if</span> n%<span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            ax = fig.add_subplot(<span class="number">8</span>, <span class="number">2</span>, n//<span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">            plot_it(x, U, n, ax, U_true)</span><br></pre></td></tr></table></figure>
</details>
<details>
<p><summary>Python code for Burgersâ€™ equation, Laxâ€“Wendroff method and the upwind method, figure 4.10</summary></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># function to plot the figure in time t</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_it</span><span class="params">(x, U, t, ax)</span>:</span></span><br><span class="line">    ax.plot(x, U, label = <span class="string">'Numerical Solution'</span>)</span><br><span class="line">    <span class="comment"># ax.plot(x, U_true, '--', label = 'Exact Solution')</span></span><br><span class="line">    t = str(t + <span class="number">1</span>) <span class="keyword">if</span> t != <span class="number">0</span> <span class="keyword">else</span> <span class="string">''</span></span><br><span class="line">    ax.set_xlabel(<span class="string">'x, t = '</span> + t + <span class="string">'Î”t'</span>)</span><br><span class="line">    ax.set_ylabel(<span class="string">'U'</span>)</span><br><span class="line">    ax.legend()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lax_wendroff</span><span class="params">(Delta_x = <span class="number">0.02</span>)</span>:</span></span><br><span class="line">    Delta_t = Delta_x</span><br><span class="line">    J = int(<span class="number">1</span> / Delta_x)</span><br><span class="line">    x = np.linspace(<span class="number">0</span>, <span class="number">1</span>, J + <span class="number">1</span>)</span><br><span class="line">    U = np.exp(<span class="number">-10</span> * (<span class="number">4</span> * x - <span class="number">1</span>)**<span class="number">2</span>)</span><br><span class="line">    U1 = U.copy() <span class="comment"># cache for U</span></span><br><span class="line">    <span class="comment"># U0 = U.copy() # cache for initial state</span></span><br><span class="line">    <span class="comment"># U_true = np.zeros(J + 1) # The exact solution</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># #    plot the initial state</span></span><br><span class="line"><span class="comment">#     initial = plt.figure(figsize=(9, 6))</span></span><br><span class="line"><span class="comment">#     ax = initial.add_subplot(1, 1, 1)</span></span><br><span class="line"><span class="comment">#     plot_it(x, U, -1, ax)</span></span><br><span class="line">    </span><br><span class="line">    fig1 = plt.figure(figsize=(<span class="number">18</span>, <span class="number">50</span>))</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, J):</span><br><span class="line">            U1[j] = U[j] - <span class="number">0.25</span> * (<span class="number">1</span> - <span class="number">0.5</span> * (U[j] + U[j + <span class="number">1</span>])) * (U[j + <span class="number">1</span>]**<span class="number">2</span> - U[j]**<span class="number">2</span>) \</span><br><span class="line">                         - <span class="number">0.25</span> * (<span class="number">1</span> + <span class="number">0.5</span> * (U[j] + U[j - <span class="number">1</span>])) * (U[j]**<span class="number">2</span> - U[j - <span class="number">1</span>]**<span class="number">2</span>)</span><br><span class="line">        U = U1.copy()</span><br><span class="line">        <span class="keyword">if</span> n%<span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            ax1 = fig1.add_subplot(<span class="number">8</span>, <span class="number">2</span>, n//<span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">            plot_it(x, U, n, ax1)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Upwind</span><span class="params">(Delta_x = <span class="number">0.02</span>)</span>:</span></span><br><span class="line">    J = int(<span class="number">1</span> / Delta_x)</span><br><span class="line">    x = np.linspace(<span class="number">0</span>, <span class="number">1</span>, J + <span class="number">1</span>)</span><br><span class="line">    U = np.exp(<span class="number">-10</span> * (<span class="number">4</span> * x - <span class="number">1</span>)**<span class="number">2</span>)</span><br><span class="line">    U1 = U.copy() <span class="comment"># cache for U</span></span><br><span class="line"><span class="comment"># #    plot the initial state</span></span><br><span class="line"><span class="comment">#     fig = plt.figure(figsize=(9, 6))</span></span><br><span class="line"><span class="comment">#     ax = fig.add_subplot(1, 1, 1)</span></span><br><span class="line"><span class="comment">#     plot_it(x, U, 0, ax)</span></span><br><span class="line">    </span><br><span class="line">    fig2 = plt.figure(figsize=(<span class="number">18</span>, <span class="number">50</span>))</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, J):</span><br><span class="line">            U1[j] = (<span class="number">1</span> - U[j]) * U[j] + U[j] * U[j - <span class="number">1</span>]</span><br><span class="line">        U = U1.copy()</span><br><span class="line">        <span class="keyword">if</span> n%<span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            ax2 = fig2.add_subplot(<span class="number">8</span>, <span class="number">2</span>, n//<span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">            plot_it(x, U, n, ax2)</span><br></pre></td></tr></table></figure>
</details>
<details>
<p><summary>Python code for box scheme, figure 4.13</summary></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># function to plot the figure in time t</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_it</span><span class="params">(x, U, t, ax, U_true = <span class="number">0</span>)</span>:</span></span><br><span class="line">    ax.plot(x, U, label = <span class="string">'Numerical Solution'</span>)</span><br><span class="line">    ax.plot(x, U_true, <span class="string">'--'</span>, label = <span class="string">'Exact Solution'</span>)</span><br><span class="line">    t = str(t + <span class="number">1</span>) <span class="keyword">if</span> t != <span class="number">0</span> <span class="keyword">else</span> <span class="string">''</span></span><br><span class="line">    ax.set_xlabel(<span class="string">'x, t = '</span> + t + <span class="string">'Î”t'</span>)</span><br><span class="line">    ax.set_ylabel(<span class="string">'U'</span>)</span><br><span class="line">    ax.legend()</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a_</span><span class="params">(n, j, Delta_x = <span class="number">0.02</span>)</span>:</span></span><br><span class="line">    Delta_t = Delta_x</span><br><span class="line">    x = j * Delta_x</span><br><span class="line">    t = n * Delta_t</span><br><span class="line">    a = (<span class="number">1</span> + x**<span class="number">2</span>) / (<span class="number">1</span> + <span class="number">2</span> * x * t + <span class="number">2</span> * x**<span class="number">2</span> + x**<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">U_</span><span class="params">(J, x, issmooth)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> issmooth:</span><br><span class="line">        U = np.exp(<span class="number">-10</span> * (<span class="number">4</span> * x - <span class="number">1</span>)**<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        U = np.zeros(J + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(J + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="number">0.2</span> &lt;= x[j] &lt;= <span class="number">0.4</span>:</span><br><span class="line">                U[j] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> U</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">box</span><span class="params">(Delta_x = <span class="number">0.02</span>, issmooth = False)</span>:</span></span><br><span class="line">    Delta_t = Delta_x</span><br><span class="line">    J = int(<span class="number">1</span> / Delta_x)</span><br><span class="line">    x = np.linspace(<span class="number">0</span>, <span class="number">1</span>, J + <span class="number">1</span>)</span><br><span class="line">    U = U_(J, x, issmooth)</span><br><span class="line">    U0 = U.copy() <span class="comment"># cache for initial state</span></span><br><span class="line">    U1 = U.copy() <span class="comment"># cache for U</span></span><br><span class="line">    U_true = np.zeros(J + <span class="number">1</span>) <span class="comment"># The exact solution</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># #    plot the initial state</span></span><br><span class="line"><span class="comment">#     initial = plt.figure(figsize=(9, 6))</span></span><br><span class="line"><span class="comment">#     ax = initial.add_subplot(1, 1, 1)</span></span><br><span class="line"><span class="comment">#     plot_it(x, U, -1, ax)</span></span><br><span class="line"></span><br><span class="line">    fig = plt.figure(figsize=(<span class="number">18</span>, <span class="number">50</span>))</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, J):</span><br><span class="line">            U1[j] = U[j - <span class="number">1</span>] + (<span class="number">1</span> - a_(n + <span class="number">0.5</span>, j + <span class="number">0.5</span>, Delta_x)) * (U[j] - U1[j - <span class="number">1</span>]) / (<span class="number">1</span> + a_(n + <span class="number">0.5</span>, j + <span class="number">0.5</span>, Delta_x))</span><br><span class="line">            j_star = (j * Delta_x - ((n + <span class="number">1</span>) * Delta_t) / (<span class="number">1</span> + (j * Delta_x)**<span class="number">2</span>)) / Delta_x</span><br><span class="line">            U_true[j] = U0[int(j_star)]</span><br><span class="line">        U = U1.copy()</span><br><span class="line">        <span class="keyword">if</span> n%<span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            ax = fig.add_subplot(<span class="number">8</span>, <span class="number">2</span>, n//<span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">            plot_it(x, U, n, ax, U_true)</span><br></pre></td></tr></table></figure>
</details>
<!-- [something useful](https://cdn.jsdelivr.net/gh/OpenWaygate/OpenWaygate.github.io@master/CDN/html/more.html  "Awesome") -->
</div>
    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/math/" rel="tag"># math</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2018/06/16/å†™åœ¨å‰é¢/" rel="next" title="é£Ÿç”¨æŒ‡å—">
                  <i class="fa fa-chevron-left"></i> é£Ÿç”¨æŒ‡å—
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2018/12/24/China-vis/" rel="prev" title="China vis">
                  China vis <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          
    
    <div class="comments" id="gitalk-container"></div>
  

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">

          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/images/avatar.png"
      alt="æ˜¯å›¢å­å•Š">
  <p class="site-author-name" itemprop="name">æ˜¯å›¢å­å•Š</p>
  <div class="site-description motion-element" itemprop="description">æ†‚é¬±æ—¥å’Œ</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
        
        
          
        
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">tags</span>
        
      </div>
    
  </nav>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
      
        
      
        <a href="https://github.com/OpenWaygate" title="GitHub &rarr; https://github.com/OpenWaygate" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i></a>
      </span>
    
      <span class="links-of-author-item">
      
      
      
        
      
        <a href="mailto:qcython@gmail.com" title="E-Mail &rarr; mailto:qcython@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i></a>
      </span>
    
      <span class="links-of-author-item">
      
      
      
        
      
        <a href="https://stackoverflow.com/users/7813311/animeta" title="StackOverflow &rarr; https://stackoverflow.com/users/7813311/animeta" rel="noopener" target="_blank"><i class="fa fa-fw fa-stack-overflow"></i></a>
      </span>
    
  </div>



        </div>
      </div>
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#u_t-u_xx"><span class="nav-number">1.</span> <span class="nav-text">\(u_t = u_{xx}\)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u_t-nabla2u"><span class="nav-number">2.</span> <span class="nav-text">\(u_t = \nabla^2u\)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#u_t-au_x-0"><span class="nav-number">3.</span> <span class="nav-text">\(u_t + au_x = 0\)</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">æ˜¯å›¢å­å•Š</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme â€“ <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.3.0</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="Total Visitors">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  
    <span class="post-meta-divider">|</span>
  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="Total Views">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>








        
      </div>
    </footer>

    

  </div>

  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

<script src="/js/utils.js?v=7.3.0"></script>
  <script src="/js/motion.js?v=7.3.0"></script>


  <script src="/js/affix.js?v=7.3.0"></script>
  <script src="/js/schemes/pisces.js?v=7.3.0"></script>


<script src="/js/next-boot.js?v=7.3.0"></script>




  




























  

  
    
      
<script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script>
<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML', () => {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script>

    
  

  

  


  
  <script src="/js/scrollspy.js?v=7.3.0"></script>
<script src="/js/post-details.js?v=7.3.0"></script>


    
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: '1cfd9f9a275c2b666cf9',
      clientSecret: '85cd60786030464319ebbad9f728469c32da13cc',
      repo: 'OpenWaygate.github.io',
      owner: 'OpenWaygate',
      admin: ['OpenWaygate'],
      id: '2ecbb688df29196cdfb6dc47a3b4b990',
        language: 'en',
      
      distractionFreeMode: 'true'
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
